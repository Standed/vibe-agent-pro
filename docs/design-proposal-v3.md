# Video Agent Pro 产品设计方案 v3.0

> **核心愿景**：像 Medeo 一样靠聊天创作，像 Seko 2.0 一样资产可控  
> **目标用户**：想做 10 分钟以上叙事视频的个人/小团队  
> **日期**：2025-12-31

---

## 一、产品定位

### 1.1 我们是谁

| 维度 | 定位 |
|------|------|
| **类型** | AI 中长视频创作平台 |
| **差异化** | 对话驱动 + 结构化管理 + 精细调控 |
| **不做** | 短视频快消、社交分享 |

### 1.2 竞品对比

| 产品 | 长视频 | 对话创作 | 精细控制 | 一致性 |
|------|---------|----------|----------|--------|
| **Seko 2.0** | ✅ 100集 | ⚠️ 弱 | ⚠️ | ✅ 强 |
| **Medeo** | ❌ 短视频 | ✅ 强Agent | ⚠️ | ⚠️ |
| **Tapnow** | ❌ 短视频 | ⚠️ | ✅ 节点流 | ⚠️ |
| **我们** | ✅ | ✅ Agent+Pro | ✅ 多Track | 🔨 待强化 |

---

## 二、核心架构

### 2.1 三大模块

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   首页 ─────────→ 策划页 ─────────→ 画布页 ─────────→ 时间轴    │
│   灵感输入        资产建立          分镜生成          视频合成    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 数据层级

```
Series (剧集)
└── Project (单集)
    ├── Script (剧本)
    ├── Characters (角色)
    ├── Scenes (场景)
    │   └── Shots (分镜)
    └── AudioAssets (音频)
```

---

## 三、详细页面设计

### 3.1 首页

```
┌──────────────────────────────────────────────────────────────────┐
│  Logo                                          [资源库] [设置]   │
├──────────────────────────────────────────────────────────────────┤
│                                                                  │
│                 ┌──────────────────────────────────┐             │
│                 │  ✨ 输入你的创作灵感...          │             │
│                 │                        [开始创作]│             │
│                 └──────────────────────────────────┘             │
│                                                                  │
│  最近项目                                                        │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐             │
│  │ 封面    │  │ 封面    │  │ 封面    │  │ + 新建  │             │
│  │ 项目名  │  │ 项目名  │  │ 项目名  │  │         │             │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘             │
│                                                                  │
└──────────────────────────────────────────────────────────────────┘
```

**交互**：
- 输入灵感 → 点击"开始创作" → 进入**策划页**
- 点击已有项目 → 进入**画布页**

---

### 3.2 策划页（独立页面）

```
┌──────────────────────────────────────────────────────────────────┐
│  ← 返回                      项目名称               [进入画布 ▶] │
├─────────────────────────────┬────────────────────────────────────┤
│                             │                                    │
│  资产面板                   │  Agent 对话                        │
│  ─────────────              │  ──────────                        │
│                             │                                    │
│  📝 剧本                    │  Agent: 你好！描述你想创作的故事...│
│  ┌───────────────────────┐  │                                    │
│  │ [展开] 查看编辑剧本   │  │  用户: 咖啡店爱情故事，3分钟      │
│  └───────────────────────┘  │                                    │
│                             │  Agent: 已为你创建：                │
│  👤 角色 (2)          [+]  │        - 角色：小明、小红           │
│  ├ 🧑 小明 (程序员)        │        - 场景：咖啡厅、公园         │
│  └ 👩 小红 (咖啡师)        │        需要生成角色形象吗？         │
│                             │                                    │
│  🏠 场景 (3)          [+]  │  用户: 好的，用即梦生成             │
│  ├ ☕ 咖啡厅                │                                    │
│  ├ 🌳 公园                  │  Agent: [生成中...] 角色形象已完成 │
│  └ 🏠 公寓                  │                                    │
│                             │  ┌──────────────────────────────┐  │
│  🎬 分镜脚本 (12)    [编辑] │  │ @角色  /命令            [发送]│  │
│  └ 预计时长: 3:12           │  └──────────────────────────────┘  │
│                             │                                    │
│  ────────────────────────   │  进度: ✅剧本 ✅角色 ✅场景 ✅分镜 │
│  [进入画布] ✅               │                                    │
│                             │                                    │
└─────────────────────────────┴────────────────────────────────────┘
         360px                          剩余宽度
```

**核心能力**：
1. **Agent 自动创建资产**：剧本→角色→场景→分镜脚本
2. **资产可编辑**：点击展开详情，用户可修改
3. **进度提示**：资产就绪后"进入画布"按钮高亮

---

### 3.3 画布页

```
┌──────────────────────────────────────────────────────────────────┐
│  ← 首页      项目名称                    [批量下载] [设置] [预览]│
├────┬─────────────────────────────────────────────┬───────────────┤
│    │                                             │               │
│ 📋 │  场景1: 咖啡厅                              │ [Agent] [Pro] │
│ 🎬 │  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐        │               │
│ 📁 │  │ 01 │ │ 02 │ │ 03 │ │ 04 │ │ 05 │        │  对话区域     │
│    │  │ 📷 │ │ 📷 │ │ ⏳ │ │ ⏳ │ │ ⏳ │        │               │
│ ─  │  └────┘ └────┘ └────┘ └────┘ └────┘        │  可拖入图片   │
│    │                                             │  作为参考     │
│    │  场景2: 公园 (▶ 收起)                       │               │
│    │  场景3: 公寓 (▶ 收起)                       │               │
│    │                                             │               │
│ ⚙️ │  ─────────────────────────────────────────  │               │
│    │                                             │               │
│    │  镜头详情 (点击分镜展开)                    │  @角色 /命令  │
│    │  ┌───────────────────────────────────────┐ │  [输入...]    │
│    │  │ Shot 03 | 女主抬头                    │ │               │
│    │  │ [大图]  景别:特写 运镜:固定 时长:2s   │ │               │
│    │  │ 历史: ○ ● ○    [应用] [重生成]       │ │               │
│    │  └───────────────────────────────────────┘ │               │
│    │                                             │               │
└────┴─────────────────────────────────────────────┴───────────────┘
 48px              可伸缩                           320px (可收起)
```

**左侧图标栏 (48px)**：
| 图标 | 功能 |
|------|------|
| 📋 | 策划（展开资产面板） |
| 🎬 | 分镜列表 |
| 📁 | 资源库 |
| ⚙️ | 设置 |

**中央画布**：
- 场景→分镜缩略图网格
- 点击分镜→底部展开详情面板
- 支持拖拽分镜到右侧对话

**右侧对话 (320px)**：
- Agent 模式：批量操作
- Pro 模式：单镜头精调

---

## 四、对话双模式

### 4.1 Agent 模式

**定位**：批量操作、全局任务

**斜杠命令**：
```
/generate-all      生成所有待生成分镜
/generate 场景1    生成指定场景
/style 赛博朋克    全局应用风格
/analyze [url]     一键拉片（从视频提取分镜）
```

**对话示例**：
```
用户: 生成场景1的所有分镜
Agent: 正在生成场景1的5个分镜...
       [进度条]
       已完成，点击查看结果
```

### 4.2 Pro 模式

**定位**：单镜头精调、多分支迭代

**斜杠命令**：
```
/redo              重新生成当前分镜
/apply             应用选中图片
/branch            创建新分支 (Track B)
/compare           对比不同版本
```

**多 Track 交互**：
```
┌─────────────────────────────────────────────┐
│ Shot 03                                     │
├─────────────────────────────────────────────┤
│   [Track A] ← 左滑 │ 当前 │ 右滑 → [Track B]│
│                                             │
│      ┌──────────┐                           │
│      │  大图    │    [应用] [重生成]        │
│      └──────────┘                           │
│                                             │
│   历史: ○ ○ ● ○ ○                           │
└─────────────────────────────────────────────┘
```

---

## 五、一致性双模式

### 5.1 三视图模式（即梦）

**适用**：动漫风格、风格化

**流程**：文生图 → 图生视频

**角色资产**：
- 三视图（3张图）
- IP角色ID
- 文字描述

### 5.2 Sora角色参考模式

**适用**：真实感、高一致性要求

**流程**：直接生视频

**角色资产优先级**：
1. Sora Identity（Sora码）
2. 参考视频
3. 正面全身图

**UI**：
```
[Sora角色参考 Tab]
┌────────────────────────────────────────────┐
│ 素材: [+上传图片] [+上传视频] [+AI生成]    │
│                                            │
│ Sora码: ______________ (可选)              │
│                                            │
│ 优先级: Sora码 > 视频 > 图片               │
└────────────────────────────────────────────┘
```

---

## 六、数据结构扩展

### 6.1 projects 表

```sql
ALTER TABLE public.projects 
  ADD COLUMN IF NOT EXISTS script JSONB DEFAULT '{}'::jsonb;
```

### 6.2 shots 表

```sql
ALTER TABLE public.shots
  ADD COLUMN IF NOT EXISTS parent_image_id TEXT,
  ADD COLUMN IF NOT EXISTS reference_ids JSONB DEFAULT '[]'::jsonb;
```

### 6.3 characters.metadata 扩展

```json
{
  "turnaroundMode": {
    "characterId": "jimeng_xxx",
    "turnaroundImages": ["url1", "url2", "url3"],
    "stylePrompt": "25岁程序员..."
  },
  "soraMode": {
    "identityId": "sora_identity_xxx",
    "referenceVideo": "url",
    "frontFullImage": "url"
  },
  "preferredMode": "turnaround" | "sora"
}
```

---

## 七、开发优先级

### Phase 1: MVP 核心闭环

| 任务 | 优先级 | 状态 |
|------|--------|------|
| 策划页 UI（左资产/右对话） | P0 | 待开发 |
| Agent 自动创建资产 | P0 | 待开发 |
| 画布页侧边栏优化 | P0 | 待开发 |
| `/generate-all` 批量生成 | P0 | 待开发 |

### Phase 2: 体验优化

| 任务 | 优先级 |
|------|--------|
| Pro 模式多 Track UI | P1 |
| 角色一致性双模式 | P1 |
| 画布拖拽到对话 | P1 |
| 血缘追溯字段 | P1 |

### Phase 3: 能力扩展

| 任务 | 优先级 |
|------|--------|
| `/analyze` 一键拉片 | P2 |
| `/style` 风格应用 | P2 |
| 公共工作流接入 | P3 |

---

## 八、降低学习成本策略

### 8.1 引导式流程

```
首页 → 策划（强引导）→ 画布（逐步放开）
```

### 8.2 智能默认值

- AI 自动填充参数
- 推荐常用景别/运镜

### 8.3 即时反馈

- 操作后立即显示进度
- 生成完成即时通知

### 8.4 新用户 5 分钟路径

1. 输入灵感 (30s)
2. Agent 生成资产 (60s)
3. 确认进入画布 (30s)
4. 一键生成全部 (60s)
5. 预览结果 (30s)
6. Pro 微调 (60s)

---

## 九、待确认事项

1. **策划页进入画布**：需要弹窗确认吗？
2. **Agent 能力边界**：能理解"改成近景"这种修改指令吗？
3. **侧边栏宽度**：48px + 200px 确认吗？
4. **详情面板位置**：底部还是右侧？
