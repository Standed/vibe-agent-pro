# Vibe Agent Pro 深度设计方案

> **基于**：用户 PDF（28页，48张竞品截图）+ 历史对话  
> **日期**：2025-12-31  
> **终极目标**：像 Medeo 一样靠聊天创作，保留精细调控能力

---

## 一、核心定位

### 用户 PDF 中明确的终局

> "我的终局是类似 Medeo 能够靠聊天就能够建立资产，批量生成编辑修改视频等等，且留有相对自由的可优化精细调控的交互。"

### 核心要求

| 要求 | 解读 |
|------|------|
| **学习成本足够低** | 新用户 5 分钟能出第一个分镜 |
| **功能好用** | 对话驱动，减少手动操作 |
| **设计美观** | 参考 Tapnow 的 UI 风格 |
| **架构灵活可扩展** | Skill 系统、公共工作流接入 |

---

## 二、v3 借鉴要点与现状对齐

### 2.1 可直接借鉴（不改架构）
- 愿景表达：像 Medeo 一样靠聊天创作，像 Seko 2.0 一样资产可控
- 三段式流程：首页 -> 策划 -> 画布（与现有结构一致）
- 策划页左右分栏：左资产 / 右 Agent 对话
- 画布三栏：左图标栏 + 中央画布 + 右对话
- 新手 5 分钟路径作为 onboarding 主叙事

### 2.2 需要对齐现有代码的点
- 剧本存储仍在 `projects.metadata.script`（短期不改 schema）
- 分镜详情入口保留现有 `ShotEditor` 弹层/侧边栏逻辑
- 血缘追溯先用 `shots.generation_history` 与 `chat_messages.metadata`

### 2.3 建议后置（Phase 2+）
- Pro 多 Track 交互
- Slash 命令体系
- 公共工作流接入（ComfyUI / RunningHub）

---

## 三、三大核心模块

### 3.1 策划模块（独立页面）

**职责**：从灵感到资产就绪

```
用户输入灵感 -> Agent 生成剧本 -> Agent 创建角色/场景 ->
用户确认/编辑资产 -> Agent 生成分镜脚本 -> [进入画布]
```

**左侧资产面板**：
- 📝 剧本（可展开编辑）
- 👤 角色列表（点击展开详情，双 Tab：三视图/Sora参考）
- 🏠 场景列表（点击展开详情）
- 🎬 分镜脚本（查看/编辑）

**右侧 Agent 对话**：
- 自动创建和修改资产
- 支持 `@角色` `@场景` 引用
- 预留 `/命令` 快捷操作（Phase 2）

### 3.2 画布模块

**职责**：分镜可视化 + 图片/视频生成

**为什么保持结构化画布而非无限画布？**

用户 PDF 中说：
> "我的团队小伙伴有人想参考他们去做这种无限画布的逻辑，但是我想着用来做长视频，画布的内容太多了，不太好显示，所以我把分镜过程都收敛到了具体的分镜下的聊天记录中。"

**我的分析**：
- 无限画布适合短视频探索
- 长视频需要层级管理（Scene → Shot）
- 结构化画布 + 详情入口 = 兼顾简约和自由

**画布布局**：
```
┌────┬───────────────────────────────────────┬──────────────┐
│图标│                                       │              │
│栏  │         场景+镜头缩略图网格           │  Agent/Pro   │
│    │                                       │   对话       │
│ 📋 │  场景1: 咖啡厅                        │              │
│ 🎬 │  ┌───┐ ┌───┐ ┌───┐ ┌───┐            │              │
│ 📁 │  │01 │ │02 │ │03 │ │04 │            │              │
│    │  └───┘ └───┘ └───┘ └───┘            │              │
│    │                                       │              │
│    │  ──────────────────────────────────  │              │
│    │                                       │              │
│    │  点击镜头 -> 进入 Pro + 打开详情     │              │
└────┴───────────────────────────────────────┴──────────────┘
 48px            可伸缩                         320px
```

**详情入口**：沿用现有 `ShotEditor` 弹层与侧边栏编辑逻辑，避免引入新的底部面板。

### 3.3 时间轴模块

**职责**：视频预览 + 简单剪辑

**现阶段不是重点**，保持现有功能。

---

## 四、Agent vs Pro 双模式

### 职责划分

| 模式 | 定位 | 能力 |
|------|------|------|
| **Agent** | 批量操作 | 创建资产、批量生成、全局修改 |
| **Pro** | 精细调控 | 单镜头迭代、参数微调（多 Track 后置） |

### 斜杠命令（Skill 系统，Phase 2）

**Agent 模式（候选）**：
```
/generate-all      一键生成所有待生成分镜
/generate 场景1    生成指定场景的分镜
/style 赛博朋克    全局应用风格
/analyze [url]     一键拉片
```

**Pro 模式（候选）**：
```
/redo              重新生成当前分镜
/apply             应用选中图片
/branch            创建新分支
/history           查看生成历史
```

---

## 五、一致性双模式

### 角色资产面板

```
┌──────────────────────────────────────────┐
│ 角色: 小明                               │
├──────────────────────────────────────────┤
│  [三视图]  |  [Sora角色参考]             │
├──────────────────────────────────────────┤
│                                          │
│  [三视图 Tab]                            │
│  ├ 三视图: [📷][📷][📷]                 │
│  ├ IP角色ID: jimeng_xxx                 │
│  └ [生成三视图] [更新IP角色]             │
│                                          │
│  [Sora角色参考 Tab]                      │
│  ├ 素材: [+上传图片] [+上传视频] [+生成] │
│  ├ Sora码: ____________ (可选)          │
│  └ 优先级: Sora码 > 视频 > 图片          │
│                                          │
└──────────────────────────────────────────┘
```

---

## 六、侧边栏优化

### 对比分析（基于 PDF 截图）

| 产品 | 侧边栏宽度 | 特点 |
|------|------------|------|
| Tapnow | ~48px 图标栏 | 极简，点击展开 |
| MulanAI | ~200px | 紧凑列表 |
| 我们现在 | ~320px | 信息丰富但较宽 |

### 优化方案

```
┌────┬────────────────────────────────┐
│    │                                │
│ 📋 │ 场景1 ▼ (快速跳转)             │
│ 🎬 │ ┌──────────────────────────┐  │
│ 📁 │ │ 01 男主进门 [📷] ⏱3s    │  │
│    │ │ 02 女主抬头 [📷] ⏱2s    │  │
│ ─  │ │ 03 对视     [⏳] ⏱4s    │  │
│ ⚙️ │ └──────────────────────────┘  │
│    │ 场景2 ▶ (5)                    │
│    │ 场景3 ▶ (2)                    │
│    │                                │
└────┴────────────────────────────────┘
 48px         200px
```

**关键改动**：
1. 48px 图标栏做 Tab 切换
2. 内容区 200px（比 320px 窄 37%）
3. 场景默认收起
4. 紧凑列表模式

---

## 七、竞品截图分析（来自 PDF）

### Tapnow

- **无限画布**：节点工作流可视化
- **分镜模式**：Storyboard 视图
- **对话**：右侧始终显示

### MulanAI

- **画布**：简约分镜网格
- **侧边栏**：紧凑资源列表

### 我们的差异化

| 维度 | 竞品 | 我们 |
|------|------|------|
| 结构 | 扁平/短视频 | 四级层级/长视频 |
| 对话 | 单一 | Agent+Pro 双模式 |
| 一致性 | 弱 | 角色/场景强关联 |

---

## 八、学习成本策略（新手 5 分钟路径）

1. 输入灵感（30s）
2. Agent 生成资产（60s）
3. 确认进入画布（30s）
4. 一键批量生成（60s）
5. 预览结果（30s）
6. Pro 微调（60s）

---

## 九、待确认问题

1. **策划页进入画布**：需要弹窗确认吗？

2. **Agent 能力边界**：
   - 只是创建/批量生成？
   - 还是能理解"把第3个镜头改成近景"？

3. **侧边栏方案**：48px + 200px 确认吗？

4. **分镜详情入口**：是否保持现有 `ShotEditor` 弹层为主入口？

---

## 附：竞品资料来源

竞品截图与分析来自用户提供的 PDF，后续如需截图分离再单独处理。
