# Agent æ¨¡å¼ä¼˜åŒ–æµ‹è¯•æ–‡æ¡£

## æµ‹è¯•æ—¥æœŸ
2025-12-08

## ä¼˜åŒ–å†…å®¹æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–åŸºäº Codex CLI æœ€ä½³å®è·µï¼Œå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

### 1. UI é‡æ„ - æ€è€ƒè¿‡ç¨‹æŠ˜å ç»„ä»¶ (ThinkingProcess)
- **æ–‡ä»¶**: `src/components/agent/ThinkingProcess.tsx` (233 è¡Œ)
- **åŠŸèƒ½**:
  - å¯æŠ˜å çš„æ€è€ƒè¿‡ç¨‹å±•ç¤ºï¼ˆå‚è€ƒ ChatGPT/Claude Codeï¼‰
  - é»˜è®¤æŠ˜å çŠ¶æ€
  - å®æ—¶è¿›åº¦æ¡æ˜¾ç¤º
  - ä¸åŒæ­¥éª¤ç±»å‹å±•ç¤ºï¼ˆæ€è€ƒã€å·¥å…·è°ƒç”¨ã€ç»“æœã€é”™è¯¯ï¼‰
  - æ‰§è¡Œæ—¶é•¿ç»Ÿè®¡

### 2. ä¸Šä¸‹æ–‡é¢„æ³¨å…¥æœåŠ¡ (Context Builder)
- **æ–‡ä»¶**: `src/services/contextBuilder.ts`
- **åŠŸèƒ½**:
  - é¢„å…ˆæ„å»ºå¢å¼ºä¸Šä¸‹æ–‡ï¼ŒåŒ…å«æ‰€æœ‰åœºæ™¯ã€åˆ†é•œã€èµ„æºä¿¡æ¯
  - å‡å°‘ AI å·¥å…·è°ƒç”¨æ¬¡æ•° 60-75%
  - æ™ºèƒ½æ”¶é›†å½“å‰åœºæ™¯å’Œåˆ†é•œçš„è¯¦ç»†ä¿¡æ¯

### 3. å¹¶è¡Œå·¥å…·æ‰§è¡Œå¼•æ“ (Parallel Executor)
- **æ–‡ä»¶**: `src/services/parallelExecutor.ts`
- **åŠŸèƒ½**:
  - åˆ†æå·¥å…·ä¾èµ–å…³ç³»
  - ç‹¬ç«‹å·¥å…·å¹¶è¡Œæ‰§è¡Œï¼ˆPromise.allï¼‰
  - ä¾èµ–å·¥å…·ä¸²è¡Œæ‰§è¡Œ
  - æ”¯æŒå¹¶è¡Œè°ƒç”¨å¤šä¸ª Gemini API

### 4. ä¼šè¯æŒä¹…åŒ–æœåŠ¡ (Session Manager)
- **æ–‡ä»¶**: `src/services/sessionManager.ts` (284 è¡Œ)
- **åŠŸèƒ½**:
  - IndexedDB ä¼šè¯å­˜å‚¨
  - ä¼šè¯è‡ªåŠ¨æ¢å¤ï¼ˆ24 å°æ—¶æœ‰æ•ˆæœŸï¼‰
  - è‡ªåŠ¨æ¸…ç†è¿‡æœŸä¼šè¯
  - ä¼šè¯æ¶ˆæ¯å†å²ç®¡ç†

### 5. useAgent Hook é›†æˆ
- **æ–‡ä»¶**: `src/hooks/useAgent.ts` (247 è¡Œ)
- **åŠŸèƒ½**:
  - é›†æˆæ‰€æœ‰ä¼˜åŒ–æœåŠ¡
  - ç»Ÿä¸€çŠ¶æ€ç®¡ç†
  - ç®€åŒ– AgentPanel ç»„ä»¶é€»è¾‘

### 6. AgentPanel ç®€åŒ–
- **æ–‡ä»¶**: `src/components/agent/AgentPanel.tsx`
- **ä¼˜åŒ–**: ä» 765 è¡Œå‡å°‘åˆ° 192 è¡Œï¼ˆå‡å°‘ 74.9%ï¼‰
- **æ”¹è¿›**:
  - ç§»é™¤å¤æ‚é€»è¾‘åˆ° useAgent hook
  - ä½¿ç”¨ ThinkingProcess ç»„ä»¶
  - æ¸…æ™°çš„æ¶ˆæ¯å±•ç¤ºç•Œé¢
  - "æ¸…é™¤ä¼šè¯" åŠŸèƒ½æŒ‰é’®

---

## æµ‹è¯•è®¡åˆ’

### å‡†å¤‡å·¥ä½œ
1. âœ… ç¡®è®¤å¼€å‘æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000
2. âœ… ç¡®è®¤æ‰€æœ‰æ–°æ–‡ä»¶å·²åˆ›å»ºä¸”æ— ç¼–è¯‘é”™è¯¯
3. âœ… ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®ï¼ˆå¦‚éœ€è®¿é—® Gemini APIï¼‰

### æµ‹è¯• 1: UI - æ€è€ƒè¿‡ç¨‹æŠ˜å ç»„ä»¶

#### æµ‹è¯•æ­¥éª¤
1. æ‰“å¼€é¡¹ç›®é¡µé¢ http://localhost:3000/project/[id]
2. åˆ‡æ¢åˆ° Agent æ¨¡å¼
3. å‘é€æµ‹è¯•æ¶ˆæ¯ï¼š"å¸®æˆ‘åˆ›å»º3ä¸ªåœºæ™¯"

#### é¢„æœŸç»“æœ
- [ ] çœ‹åˆ°æ€è€ƒè¿‡ç¨‹ç»„ä»¶å‡ºç°
- [ ] é»˜è®¤çŠ¶æ€æ˜¯æŠ˜å çš„ï¼ˆåªæ˜¾ç¤ºè¿›åº¦æ¡å’Œæ€»ç»“ï¼‰
- [ ] ç‚¹å‡»å±•å¼€æŒ‰é’®å¯ä»¥æŸ¥çœ‹è¯¦ç»†æ­¥éª¤
- [ ] æ­¥éª¤ç±»å‹å›¾æ ‡æ­£ç¡®æ˜¾ç¤ºï¼š
  - ğŸ’­ æ€è€ƒä¸­
  - ğŸ”§ å·¥å…·è°ƒç”¨
  - âœ“ ç»“æœ
  - âœ— é”™è¯¯
- [ ] è¿›åº¦æ¡éšç€æ­¥éª¤å®Œæˆè€Œæ›´æ–°
- [ ] æ˜¾ç¤ºæ‰§è¡Œæ—¶é•¿
- [ ] å®Œæˆåæ˜¾ç¤ºæœ€ç»ˆæ‘˜è¦

### æµ‹è¯• 2: ä¸Šä¸‹æ–‡é¢„æ³¨å…¥ - å‡å°‘å·¥å…·è°ƒç”¨

#### æµ‹è¯•æ­¥éª¤
1. åœ¨ Agent ä¸­å‘é€æ¶ˆæ¯ï¼š"å½“å‰é¡¹ç›®æœ‰å¤šå°‘ä¸ªåœºæ™¯ï¼Ÿ"
2. è§‚å¯Ÿ Network é¢æ¿ä¸­çš„ API è°ƒç”¨

#### é¢„æœŸç»“æœ
- [ ] AI ç›´æ¥ä»ä¸Šä¸‹æ–‡ä¸­è·å–ä¿¡æ¯ï¼Œæ— éœ€è°ƒç”¨ `getProjectContext` å·¥å…·
- [ ] å“åº”é€Ÿåº¦æ›´å¿«ï¼ˆæ— éœ€é¢å¤–å·¥å…·è°ƒç”¨ï¼‰
- [ ] è¿”å›å‡†ç¡®çš„åœºæ™¯æ•°é‡

#### å¯¹æ¯”æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- æ—§ç‰ˆæœ¬éœ€è¦ 2-3 æ¬¡å·¥å…·è°ƒç”¨æ‰èƒ½å›ç­”
- æ–°ç‰ˆæœ¬åº”è¯¥ 0-1 æ¬¡å·¥å…·è°ƒç”¨

### æµ‹è¯• 3: å¹¶è¡Œæ‰§è¡Œ - æ€§èƒ½ä¼˜åŒ–

#### æµ‹è¯•æ­¥éª¤
1. å‘é€å¤æ‚ä»»åŠ¡ï¼š"å¸®æˆ‘åˆ›å»º3ä¸ªåœºæ™¯ï¼Œæ¯ä¸ªåœºæ™¯æ·»åŠ 2ä¸ªåˆ†é•œ"
2. è§‚å¯Ÿæ€è€ƒè¿‡ç¨‹å±•å¼€åçš„æ­¥éª¤æ‰§è¡Œé¡ºåº

#### é¢„æœŸç»“æœ
- [ ] è¯»å–æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼ˆå¦‚å¤šä¸ªåœºæ™¯æŸ¥è¯¢ï¼‰
- [ ] å†™å…¥æ“ä½œä¸²è¡Œæ‰§è¡Œï¼ˆåˆ›å»ºåœºæ™¯ã€æ·»åŠ åˆ†é•œï¼‰
- [ ] æ€è€ƒè¿‡ç¨‹ä¸­æ˜¾ç¤º"å¹¶è¡Œæ‰§è¡Œ N ä¸ªç‹¬ç«‹å·¥å…·"
- [ ] æ€»æ‰§è¡Œæ—¶é—´æ˜æ˜¾å‡å°‘ï¼ˆç›¸æ¯”ä¸²è¡Œæ‰§è¡Œï¼‰

### æµ‹è¯• 4: ä¼šè¯æŒä¹…åŒ– - IndexedDB

#### æµ‹è¯•æ­¥éª¤
1. åœ¨ Agent ä¸­è¿›è¡Œå¯¹è¯ï¼š"å¸®æˆ‘åˆ›å»ºä¸€ä¸ªåœºæ™¯"
2. æ‰“å¼€æµè§ˆå™¨ DevTools > Application > IndexedDB
3. æŸ¥çœ‹ `video-agent-sessions` æ•°æ®åº“

#### é¢„æœŸç»“æœ
- [ ] çœ‹åˆ° `sessions` è¡¨
- [ ] ä¼šè¯ ID æ ¼å¼ï¼š`session_[timestamp]_[random]`
- [ ] ä¼šè¯åŒ…å«ä»¥ä¸‹å­—æ®µï¼š
  - `id`: ä¼šè¯ ID
  - `projectId`: é¡¹ç›® ID
  - `context`: å¢å¼ºä¸Šä¸‹æ–‡
  - `messages`: æ¶ˆæ¯å†å²
  - `createdAt`: åˆ›å»ºæ—¶é—´
  - `updatedAt`: æ›´æ–°æ—¶é—´
  - `expiresAt`: è¿‡æœŸæ—¶é—´ï¼ˆ24 å°æ—¶åï¼‰

#### æŒä¹…åŒ–æµ‹è¯•
1. åˆ·æ–°é¡µé¢
2. å†æ¬¡æ‰“å¼€ Agent æ¨¡å¼
3. å‘é€æ–°æ¶ˆæ¯

#### é¢„æœŸç»“æœ
- [ ] ä¼šè¯è‡ªåŠ¨æ¢å¤ï¼ˆä» IndexedDB åŠ è½½ï¼‰
- [ ] ç»§æ‰¿ä¹‹å‰çš„ä¸Šä¸‹æ–‡
- [ ] æ¶ˆæ¯å†å²ä¿ç•™

### æµ‹è¯• 5: æ¸…é™¤ä¼šè¯åŠŸèƒ½

#### æµ‹è¯•æ­¥éª¤
1. åœ¨ Agent é¢æ¿å³ä¸Šè§’ç‚¹å‡»"åƒåœ¾æ¡¶"å›¾æ ‡ï¼ˆæ¸…é™¤ä¼šè¯ï¼‰
2. æ£€æŸ¥ IndexedDB

#### é¢„æœŸç»“æœ
- [ ] å½“å‰ä¼šè¯ä» IndexedDB ä¸­åˆ é™¤
- [ ] èŠå¤©å†å²æ¸…ç©º
- [ ] ä¸‹æ¬¡å‘é€æ¶ˆæ¯ä¼šåˆ›å»ºæ–°ä¼šè¯

### æµ‹è¯• 6: é”™è¯¯å¤„ç†

#### æµ‹è¯•æ­¥éª¤
1. å‘é€æ— æ•ˆè¯·æ±‚ï¼š"åˆ é™¤æ‰€æœ‰åœºæ™¯"ï¼ˆå‡è®¾æ²¡æœ‰æ­¤å·¥å…·ï¼‰
2. è§‚å¯Ÿé”™è¯¯æ˜¾ç¤º

#### é¢„æœŸç»“æœ
- [ ] æ€è€ƒè¿‡ç¨‹ä¸­æ˜¾ç¤ºé”™è¯¯æ­¥éª¤ï¼ˆçº¢è‰² X å›¾æ ‡ï¼‰
- [ ] é”™è¯¯ä¿¡æ¯æ¸…æ™°å¯è¯»
- [ ] å…¶ä»–æ­¥éª¤ç»§ç»­æ‰§è¡Œï¼ˆå¦‚æœå¯èƒ½ï¼‰
- [ ] æœ€ç»ˆæ‘˜è¦åŒ…å«é”™è¯¯è¯´æ˜

### æµ‹è¯• 7: ä»£ç è´¨é‡éªŒè¯

#### æ–‡ä»¶é•¿åº¦æ£€æŸ¥
```bash
wc -l src/components/agent/AgentPanel.tsx
wc -l src/components/agent/ThinkingProcess.tsx
wc -l src/hooks/useAgent.ts
wc -l src/services/contextBuilder.ts
wc -l src/services/parallelExecutor.ts
wc -l src/services/sessionManager.ts
```

#### é¢„æœŸç»“æœ
- [ ] AgentPanel.tsx â‰¤ 200 è¡Œ (å½“å‰ 192 è¡Œ) âœ…
- [ ] ThinkingProcess.tsx â‰¤ 250 è¡Œ (å½“å‰ 233 è¡Œ) âœ…
- [ ] useAgent.ts â‰¤ 250 è¡Œ (å½“å‰ 247 è¡Œ) âœ…
- [ ] contextBuilder.ts â‰¤ 300 è¡Œ âœ…
- [ ] parallelExecutor.ts â‰¤ 300 è¡Œ âœ…
- [ ] sessionManager.ts â‰¤ 300 è¡Œ (å½“å‰ 284 è¡Œ) âœ…

æ‰€æœ‰æ–‡ä»¶å‡ < 1000 è¡Œ âœ…

### æµ‹è¯• 8: æ€§èƒ½å¯¹æ¯”ï¼ˆå¯é€‰ï¼‰

#### æµ‹è¯•åœºæ™¯
åˆ›å»º 5 ä¸ªåœºæ™¯ï¼Œæ¯ä¸ªåœºæ™¯ 3 ä¸ªåˆ†é•œï¼ˆå…± 15 ä¸ªåˆ†é•œï¼‰

#### æµ‹é‡æŒ‡æ ‡
- æ€»æ‰§è¡Œæ—¶é—´
- å·¥å…·è°ƒç”¨æ¬¡æ•°
- API è¯·æ±‚æ¬¡æ•°

#### é¢„æœŸæ”¹è¿›
- æ‰§è¡Œæ—¶é—´å‡å°‘: 40-60%
- å·¥å…·è°ƒç”¨å‡å°‘: 60-75%
- API è¯·æ±‚æ•°å‡å°‘: 50-70%

---

## å·²çŸ¥é—®é¢˜ & æ³¨æ„äº‹é¡¹

### 1. Next.js Build Manifest è­¦å‘Š
```
â¨¯ [Error: ENOENT: no such file or directory, open '.../_buildManifest.js.tmp.xxx']
```
**è¯´æ˜**: è¿™æ˜¯å·²çŸ¥çš„ Next.js/Turbopack é—®é¢˜ï¼Œä¸å½±å“åº”ç”¨è¿è¡Œ

### 2. Webpack é…ç½®è­¦å‘Š
```
âš  Webpack is configured while Turbopack is not
```
**è¯´æ˜**: Next.js 15 ä½¿ç”¨ Turbopackï¼Œæ­¤è­¦å‘Šå¯å¿½ç•¥

### 3. ä»£ç†é…ç½®
å¦‚æœéœ€è¦è®¿é—® Gemini APIï¼Œç¡®ä¿ä»¥ä¸‹ç¯å¢ƒå˜é‡å·²è®¾ç½®ï¼š
```env
HTTP_PROXY=http://127.0.0.1:7897
HTTPS_PROXY=http://127.0.0.1:7897
```

---

## æµ‹è¯•ç»“æœè®°å½•

### æµ‹è¯•æ‰§è¡Œäºº
_[å¾…å¡«å†™]_

### æµ‹è¯•æ—¥æœŸ
_[å¾…å¡«å†™]_

### æµ‹è¯•ç»“æœ
| æµ‹è¯•é¡¹ | é€šè¿‡ | å¤±è´¥ | å¤‡æ³¨ |
|--------|------|------|------|
| æµ‹è¯• 1: UI æŠ˜å ç»„ä»¶ | â˜ | â˜ | |
| æµ‹è¯• 2: ä¸Šä¸‹æ–‡é¢„æ³¨å…¥ | â˜ | â˜ | |
| æµ‹è¯• 3: å¹¶è¡Œæ‰§è¡Œ | â˜ | â˜ | |
| æµ‹è¯• 4: ä¼šè¯æŒä¹…åŒ– | â˜ | â˜ | |
| æµ‹è¯• 5: æ¸…é™¤ä¼šè¯ | â˜ | â˜ | |
| æµ‹è¯• 6: é”™è¯¯å¤„ç† | â˜ | â˜ | |
| æµ‹è¯• 7: ä»£ç è´¨é‡ | â˜ | â˜ | |
| æµ‹è¯• 8: æ€§èƒ½å¯¹æ¯” | â˜ | â˜ | |

### å‘ç°çš„é—®é¢˜
_[å¾…å¡«å†™]_

### æ”¹è¿›å»ºè®®
_[å¾…å¡«å†™]_

---

## ä¸‹ä¸€æ­¥

æµ‹è¯•å®Œæˆåï¼Œå¦‚æœæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š
1. âœ… æ ‡è®°"æµ‹è¯•ä¼˜åŒ–åçš„ Agent æ¨¡å¼"ä»»åŠ¡ä¸ºå®Œæˆ
2. è¿›è¡Œå…¨åŠŸèƒ½æµ‹è¯•
3. å‡†å¤‡ GitHub æäº¤

å¦‚æœæœ‰é—®é¢˜ï¼š
1. è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. ä¿®å¤é—®é¢˜
3. é‡æ–°æµ‹è¯•
